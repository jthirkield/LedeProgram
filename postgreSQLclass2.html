
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">
<head>
    <title>LEDE PROGRAM: DATA AND DATABASES DAY 1</title>
    <style type="text/css" media="screen" title="Normal Text">@import url("https://www.postgresql.org/dyncss/docs.css?883d0de6");
    </style>
    <style>
 .hlite { 
    background-color: yellow;
}
    </style>
    <script type="text/javascript" src="https://www.postgresql.org/media/js/monospacefix.js?883d0de6"></script>
</head>
<body>

<div id="docContainerWrap">
<div id="docContainer">
<div id="docNavSearchContainer">

<div id="docContent">


<div class="SECT1">
  <h1 class="SECT1"><a name="DML-INSERT" id="DML-INSERT"> LEDE PROGRAM: DATA AND DATABASES DAY 2</a></h1>
  <h1 class="SECT1"><a name="DML-INSERT" id="DML-INSERT">  Here's my summary yesterday's SQL fun in class. </a></h1>
 <P> 

Once we installed the Mondail database we listed the tables using the <span class="hlite">\dt</span> command.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# \dt
             List of relations
 Schema |       Name        | Type  | Owner 
--------+-------------------+-------+-------
 public | airport           | table | Jon
 public | borders           | table | Jon
 public | city              | table | Jon
 public | cityothername     | table | Jon
 public | citypops          | table | Jon
 public | continent         | table | Jon
 public | country           | table | Jon
 public | countryothername  | table | Jon
 public | countrypops       | table | Jon
 public | desert            | table | Jon
 public | economy           | table | Jon
 public | encompasses       | table | Jon
 public | ethnicgroup       | table | Jon
 public | geo_desert        | table | Jon
 public | geo_estuary       | table | Jon
 public | geo_island        | table | Jon
 public | geo_lake          | table | Jon
 public | geo_mountain      | table | Jon
 public | geo_river         | table | Jon
 public | geo_sea           | table | Jon
 public | geo_source        | table | Jon
 public | island            | table | Jon
 public | islandin          | table | Jon
 public | ismember          | table | Jon
 public | lake              | table | Jon
 public | lakeonisland      | table | Jon
 public | language          | table | Jon
 public | located           | table | Jon
 public | locatedon         | table | Jon
 public | mergeswith        | table | Jon
 public | mountain          | table | Jon
 public | mountainonisland  | table | Jon
 public | organization      | table | Jon

</pre>
<p>
Note that I stopped the list by pressing <span class="hlite">q</span>. On a Mac <span class="hlite">control + f </span>and <span class="hlite">control + b </span>lets you page down or page up respectively--instead of pressing return or the down arrow to get one line at a time.
</p><p>
Next we checked the columns of the mysterious table "countryothername" using <span class="hlite">\d+</span>
</P>
 <pre class="PROGRAMLISTING">
mondial2=# \d+ countryothername
                            Table "public.countryothername"
  Column   |         Type          | Modifiers | Storage  | Stats target | Description 
-----------+-----------------------+-----------+----------+--------------+-------------
 country   | character varying(4)  | not null  | extended |              | 
 othername | character varying(50) | not null  | extended |              | 
Indexes:
    "countryothernamekey" PRIMARY KEY, btree (country, othername)

</pre>
<p>
Then we selected all the rows in that table, and discovered that there were none.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT * FROM countryothername;
 country | othername 
---------+-----------
(0 rows)
</pre>
<p>
So we decided to take a peek at the religion table. Again <span class="hlite">\d+ tablename </span>gave us the details on the columns.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# \d+ religion
                                Table "public.religion"
   Column   |         Type          | Modifiers | Storage  | Stats target | Description 
------------+-----------------------+-----------+----------+--------------+-------------
 country    | character varying(4)  | not null  | extended |              | 
 name       | character varying(50) | not null  | extended |              | 
 percentage | numeric               |           | main     |              | 
Indexes:
    "religionkey" PRIMARY KEY, btree (name, country)
Check constraints:
    "religionpercent" CHECK (percentage > 0::numeric AND percentage <= 100::numeric)
  </pre>
<p>  
We found out that it had three columns: country, name, and percentage. So then we decided to take a look at all the rows and columns.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT * FROM religion;
 country |            name             | percentage 
---------+-----------------------------+------------
 AL      | Muslim                      |         70
 AL      | Roman Catholic              |         10
 AL      | Christian Orthodox          |         20
 GR      | Christian Orthodox          |         98
 GR      | Muslim                      |        1.3
 MK      | Christian Orthodox          |       64.7
 MK      | Muslim                      |       33.3
 MK      | Roman Catholic              |        0.2
 SRB     | Christian Orthodox          |         85
 SRB     | Muslim                      |        3.2
 SRB     | Roman Catholic              |        5.5
 SRB     | Protestant                  |        1.1
 MNE     | Christian Orthodox          |       74.2
 MNE     | Muslim                      |       17.7
 MNE     | Roman Catholic              |        3.5
 KOS     | Muslim                      |         90
 AND     | Roman Catholic              |         95
 F       | Roman Catholic              |         85
 F       | Muslim                      |          8
 F       | Protestant                  |          2
 F       | Jewish                      |          1
 E       | Roman Catholic              |         94
 A       | Roman Catholic              |         85
 A       | Protestant                  |          6
 CZ      | Roman Catholic              |       26.8
 CZ      | Protestant                  |        2.1
 D       | Roman Catholic              |         34
 D       | Protestant                  |         34
 D       | Muslim                      |        3.7
 H       | Roman Catholic              |       51.9
 H       | Protestant                  |       18.9
 I       | Roman Catholic              |       84.6
 I       | Christian Orthodox          |        2.0
 I       | Protestant                  |        0.9
 I       | Muslim                      |        2.1
 I       | Buddhist                    |        0.3
 I       | Hindu                       |        0.2
 FL      | Roman Catholic              |       76.2
 FL      | Protestant                  |          7
 SK      | Roman Catholic              |       68.9
 </pre>
<p>
Then we took a look at all the rows, but only two columns (name and percentage).
 </P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT name, percentage FROM religion;
            name             | percentage 
-----------------------------+------------
 Muslim                      |         70
 Roman Catholic              |         10
 Christian Orthodox          |         20
 Christian Orthodox          |         98
 Muslim                      |        1.3
 Christian Orthodox          |       64.7
 Muslim                      |       33.3
 Roman Catholic              |        0.2
 Christian Orthodox          |         85
 Muslim                      |        3.2
 Roman Catholic              |        5.5
 Protestant                  |        1.1
 Christian Orthodox          |       74.2
 Muslim                      |       17.7
 Roman Catholic              |        3.5
 Muslim                      |         90
 Roman Catholic              |         95
 Roman Catholic              |         85
 Muslim                      |          8
 Protestant                  |          2
 Jewish                      |          1
</pre>
<p>
Next we used<span class="hlite"> DISTINCT </span>to get a list of every religion in the table. Because these religions are named many times, as they are practiced in many countries, we only wanted to look at the column "name".
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT DISTINCT name FROM religion;
            name             
-----------------------------
 Buddhist
 African Methodist Episcopal
 Jehovas Witnesses
 Ekalesia Niue
 Jains
 United
 Mayan
 Armenian Apostolic
 Taoist
 Kimbanguist
 Coptic Christian
 Presbyterian
 New Apostolic
 Hoa Hao
 Muslim
 Sikh
 Church Tuvalu
 United Church
 Jewish
 Baptist
 Episcopalian
 Christian Congregationalist
 Uniting Church Australia
 Anglican
 Seventh-Day Adventist
 Confucianism
 Church of God
 Cao Dai
 Congregational Christian
 Church Christ
 Chondogyo
 Adventist
 Christian
 Christian Orthodox
 Ukrainian Greek Catholic
 Druze
 Methodist
 Roman Catholic
 Mormon
 Protestant
 Hindu
 Bahai
 Yezidi
(43 rows)
</pre>
<p>
There are 43 distinct religions in the table.
</P><P>
Here's an example getting all the rows again.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT * FROM religion;
 country |            name             | percentage 
---------+-----------------------------+------------
 AL      | Muslim                      |         70
 AL      | Roman Catholic              |         10
 AL      | Christian Orthodox          |         20
 GR      | Christian Orthodox          |         98
 GR      | Muslim                      |        1.3
 MK      | Christian Orthodox          |       64.7
 MK      | Muslim                      |       33.3
 MK      | Roman Catholic              |        0.2
 SRB     | Christian Orthodox          |         85
 SRB     | Muslim                      |        3.2
 SRB     | Roman Catholic              |        5.5
 SRB     | Protestant                  |        1.1
 MNE     | Christian Orthodox          |       74.2
 MNE     | Muslim                      |       17.7
 MNE     | Roman Catholic              |        3.5
 KOS     | Muslim                      |         90
 AND     | Roman Catholic              |         95
 F       | Roman Catholic              |         85
 F       | Muslim                      |          8
 F       | Protestant                  |          2
 F       | Jewish                      |          1
 </pre>
<p>
 Here I decided to explicitly write out the names of each column, and put them in a different order so that my output would change. I also added the<span class="hlite"> WHERE </span>conditional statement that only shows me rows in which the percentage is over 50.
 </P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT name, percentage, country FROM religion WHERE percentage > 50; 
           name           | percentage | country 
--------------------------+------------+---------
 Muslim                   |         70 | AL
 Christian Orthodox       |         98 | GR
 Christian Orthodox       |       64.7 | MK
 Christian Orthodox       |         85 | SRB
 Christian Orthodox       |       74.2 | MNE
 Muslim                   |         90 | KOS
 Roman Catholic           |         95 | AND
 Roman Catholic           |         85 | F
 Roman Catholic           |         94 | E
 Roman Catholic           |         85 | A
 Roman Catholic           |       51.9 | H
 Roman Catholic           |       84.6 | I
 Roman Catholic           |       76.2 | FL
 Roman Catholic           |       68.9 | SK
 Roman Catholic           |         96 | SLO
 Christian Orthodox       |         80 | BY
 Roman Catholic           |         79 | LT
 Roman Catholic           |         95 | PL
 Christian Orthodox       |       83.5 | UA
 Roman Catholic           |         75 | B
 Roman Catholic           |         87 | L
 Roman Catholic           |       87.8 | HR
 Christian Orthodox       |       59.4 | BG
 Christian Orthodox       |       86.8 | RO
 Muslim                   |       99.8 | TR
 Protestant               |         95 | DK
 </pre>
<p>
Below is the first query that I spread over two lines. The first line is a simple select all columns from the table. The second line is a<span class="hlite"> WHERE </span>statement with two conditionals: It tests for columns in which the percentage is greater than 50 <span class="hlite">AND </span>for columns in which the religion's name is 'Muslim'.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT * FROM religion
mondial2-# WHERE percentage > 50 AND name = 'Muslim';
 country |  name  | percentage 
---------+--------+------------
 AL      | Muslim |         70
 KOS     | Muslim |         90
 TR      | Muslim |       99.8
 AFG     | Muslim |         99
 IR      | Muslim |         99
 PK      | Muslim |         97
 TAD     | Muslim |         90
 TM      | Muslim |         89
 UZB     | Muslim |         88
 AZ      | Muslim |       93.4
 BRN     | Muslim |        100
 BD      | Muslim |         83
 BRU     | Muslim |         63
 MAL     | Muslim |       60.4
 KGZ     | Muslim |         75
 COCO    | Muslim |         80
 GAZA    | Muslim |       98.7
 ET      | Muslim |         94
 RI      | Muslim |         87
 IRQ     | Muslim |         97
 JOR     | Muslim |         92
 </pre>
<p>
Then we decided we wanted the country's name instead of the country code. So we looked into the<span class="hlite"> 'country' </span>table to see its columns.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# \d+ country
                                 Table "public.country"
   Column   |         Type          | Modifiers | Storage  | Stats target | Description 
------------+-----------------------+-----------+----------+--------------+-------------
 name       | character varying(50) | not null  | extended |              | 
 code       | character varying(4)  | not null  | extended |              | 
 capital    | character varying(50) |           | extended |              | 
 province   | character varying(50) |           | extended |              | 
 area       | numeric               |           | main     |              | 
 population | numeric               |           | main     |              | 
Indexes:
    "countrykey" PRIMARY KEY, btree (code)
    "country_name_key" UNIQUE CONSTRAINT, btree (name)
Check constraints:
    "countryarea" CHECK (area >= 0::numeric)
    "countrypop" CHECK (population >= 0::numeric)
    
   </pre>
<p> 
Next we did our first query across two tables. Because we are using two tables we had to use dot notation to specify which column belongs to which table. For example <span class="hlite">country.name </span>means the 'name' column inside the 'country' table.

Instead of using join, I wrote a<span class="hlite"> WHERE </span>conditional that had three conditions -- the most important one being that country.code match religion.country. That searches for the <span class="hlite">primary key (country.code) </span>and joins the two tables, even without using the JOIN command.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country.name, religion.name, religion.percentage
mondial2-# FROM country, religion
mondial2-# WHERE country.code = religion.country AND religion.percentage > 50
mondial2-# AND religion.name = 'Muslim';
         name         |  name  | percentage 
----------------------+--------+------------
 Albania              | Muslim |         70
 Kosovo               | Muslim |         90
 Turkey               | Muslim |       99.8
 Afghanistan          | Muslim |         99
 Iran                 | Muslim |         99
 Pakistan             | Muslim |         97
 Tajikistan           | Muslim |         90
 Turkmenistan         | Muslim |         89
 Uzbekistan           | Muslim |         88
 Azerbaijan           | Muslim |       93.4
 Bahrain              | Muslim |        100
 Bangladesh           | Muslim |         83
 Brunei               | Muslim |         63
 Malaysia             | Muslim |       60.4
 Kyrgyzstan           | Muslim |         75
 Cocos Islands        | Muslim |         80
 Gaza Strip           | Muslim |       98.7
 Egypt                | Muslim |         94
 Indonesia            | Muslim |         87
 Iraq                 | Muslim |         97
 Jordan               | Muslim |         92

</pre>
<p>
In this example we used<span class="hlite"> JOIN </span>without doing any of the other tests--dropping the previous WHERE command. Here: for every row in the 'religion' table it is finding the matching country name from the 'country' table using the test <span class="hlite">ON country.code = religion.country"</span>
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country.name, religion.name, religion.percentage 
FROM religion 
JOIN country ON country.code = religion.country;


           name            |            name             | percentage 
---------------------------+-----------------------------+------------
 Albania                   | Muslim                      |         70
 Albania                   | Roman Catholic              |         10
 Albania                   | Christian Orthodox          |         20
 Greece                    | Christian Orthodox          |         98
 Greece                    | Muslim                      |        1.3
 Macedonia                 | Christian Orthodox          |       64.7
 Macedonia                 | Muslim                      |       33.3
 Macedonia                 | Roman Catholic              |        0.2
 Serbia                    | Christian Orthodox          |         85
 Serbia                    | Muslim                      |        3.2
 Serbia                    | Roman Catholic              |        5.5
 Serbia                    | Protestant                  |        1.1
 Montenegro                | Christian Orthodox          |       74.2
 Montenegro                | Muslim                      |       17.7
 Montenegro                | Roman Catholic              |        3.5
 Kosovo                    | Muslim                      |         90
 Andorra                   | Roman Catholic              |         95
 France                    | Roman Catholic              |         85
 France                    | Muslim                      |          8
 France                    | Protestant                  |          2
 France                    | Jewish                      |          1
 
 </pre>
<p>
Finally I add the<span class="hlite"> WHERE </span>conditions again, and we get our results for countries with a majority Muslim population. The <span class="hlite">JOIN </span>allows us to see the full name of the country rather than the country code (because the 'religion' table only has the country code not the complete name of the country).
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country.name, religion.name, religion.percentage              
FROM religion 
JOIN country ON country.code = religion.country                   
WHERE religion.name = 'Muslim' AND religion.percentage > 50;

         name         |  name  | percentage 
----------------------+--------+------------
 Albania              | Muslim |         70
 Kosovo               | Muslim |         90
 Turkey               | Muslim |       99.8
 Afghanistan          | Muslim |         99
 Iran                 | Muslim |         99
 Pakistan             | Muslim |         97
 Tajikistan           | Muslim |         90
 Turkmenistan         | Muslim |         89
 Uzbekistan           | Muslim |         88
 Azerbaijan           | Muslim |       93.4
 Bahrain              | Muslim |        100
 Bangladesh           | Muslim |         83
 Brunei               | Muslim |         63
 Malaysia             | Muslim |       60.4
 Kyrgyzstan           | Muslim |         75
 Cocos Islands        | Muslim |         80
 Gaza Strip           | Muslim |       98.7
 Egypt                | Muslim |         94
 Indonesia            | Muslim |         87
 Iraq                 | Muslim |         97
 Jordan               | Muslim |         92
 </pre>
<p>
Here I introduced the<span class="hlite"> ORDER BY </span>command -- so we get our results in alphabetical order.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country.name, religion.name, religion.percentage
FROM religion JOIN country ON country.code = religion.country
WHERE religion.name = 'Muslim' AND religion.percentage > 50
ORDER BY country.name;
         name         |  name  | percentage 
----------------------+--------+------------
 Afghanistan          | Muslim |         99
 Albania              | Muslim |         70
 Algeria              | Muslim |         99
 Azerbaijan           | Muslim |       93.4
 Bahrain              | Muslim |        100
 Bangladesh           | Muslim |         83
 Brunei               | Muslim |         63
 Cocos Islands        | Muslim |         80
 Comoros              | Muslim |         86
 Cote d'Ivoire        | Muslim |         60
 Djibouti             | Muslim |         94
 Egypt                | Muslim |         94
 Gambia               | Muslim |         90
 Gaza Strip           | Muslim |       98.7
 Guinea               | Muslim |         85
 Indonesia            | Muslim |         87
 Iran                 | Muslim |         99
 Iraq                 | Muslim |         97
 Jordan               | Muslim |         92
 Kosovo               | Muslim |         90
 Kuwait               | Muslim |         85
 </pre>
<p>
Below the<span class="hlite"> DESC </span>command changes the order to reverse alphabetical order.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country.name, religion.name, religion.percentage              
FROM religion JOIN country ON country.code = religion.country                   
WHERE religion.name = 'Muslim'AND religion.percentage > 50                                                    ORDER BY country.name DESC;

         name         |  name  | percentage 
----------------------+--------+------------
 Yemen                | Muslim |         98
 Western Sahara       | Muslim |        100
 West Bank            | Muslim |         75
 Uzbekistan           | Muslim |         88
 United Arab Emirates | Muslim |         96
 Turkmenistan         | Muslim |         89
 Turkey               | Muslim |       99.8
 Tunisia              | Muslim |         98
 Tajikistan           | Muslim |         90
 Syria                | Muslim |         90
 Sudan                | Muslim |         95
 Somalia              | Muslim |        100
 Sierra Leone         | Muslim |         60
 Senegal              | Muslim |         92
 Saudi Arabia         | Muslim |        100
 Qatar                | Muslim |         95
 Pakistan             | Muslim |         97
 Oman                 | Muslim |         75
 Niger                | Muslim |         80
 Morocco              | Muslim |       98.7
 Mayotte              | Muslim |         90
 </pre>
<p>
Exact same query, except we are ordering by percentage.

</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country.name, religion.name, religion.percentage
FROM religion JOIN country ON country.code = religion.country
WHERE religion.name = 'Muslim' AND religion.percentage > 50
ORDER BY religion.percentage DESC;
         name         |  name  | percentage 
----------------------+--------+------------
 Bahrain              | Muslim |        100
 Mauritania           | Muslim |        100
 Western Sahara       | Muslim |        100
 Maldives             | Muslim |        100
 Saudi Arabia         | Muslim |        100
 Somalia              | Muslim |        100
 Turkey               | Muslim |       99.8
 Afghanistan          | Muslim |         99
 Iran                 | Muslim |         99
 Algeria              | Muslim |         99
 Morocco              | Muslim |       98.7
 Gaza Strip           | Muslim |       98.7
 Tunisia              | Muslim |         98
 Yemen                | Muslim |         98
 Libya                | Muslim |         97
 Iraq                 | Muslim |         97
 Pakistan             | Muslim |         97
 United Arab Emirates | Muslim |         96
 Sudan                | Muslim |         95
 Qatar                | Muslim |         95
 Djibouti             | Muslim |         94
</pre>
<p>
Same thing again, but we are ordering first by percentage, and then alphabetically.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country.name, religion.name, religion.percentage
FROM religion JOIN country ON country.code = religion.country
WHERE religion.name = 'Muslim' AND religion.percentage > 50
ORDER BY religion.percentage DESC, country.name;
         name         |  name  | percentage 
----------------------+--------+------------
 Bahrain              | Muslim |        100
 Maldives             | Muslim |        100
 Mauritania           | Muslim |        100
 Saudi Arabia         | Muslim |        100
 Somalia              | Muslim |        100
 Western Sahara       | Muslim |        100
 Turkey               | Muslim |       99.8
 Afghanistan          | Muslim |         99
 Algeria              | Muslim |         99
 Iran                 | Muslim |         99
 Gaza Strip           | Muslim |       98.7
 Morocco              | Muslim |       98.7
 Tunisia              | Muslim |         98
 Yemen                | Muslim |         98
 Iraq                 | Muslim |         97
 Libya                | Muslim |         97
 Pakistan             | Muslim |         97
 United Arab Emirates | Muslim |         96
 Qatar                | Muslim |         95
 Sudan                | Muslim |         95
 Djibouti             | Muslim |         94
 Egypt                | Muslim |         94
 
 </pre>
<p>
Same as above except I limit the results to the first 10 using<span class="hlite"> LIMIT </span>
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country.name, religion.name, religion.percentage
FROM religion JOIN country ON country.code = religion.country
WHERE religion.name = 'Muslim' AND religion.percentage > 50
ORDER BY religion.percentage DESC, country.name
LIMIT 10;

      name      |  name  | percentage 
----------------+--------+------------
 Bahrain        | Muslim |        100
 Maldives       | Muslim |        100
 Mauritania     | Muslim |        100
 Saudi Arabia   | Muslim |        100
 Somalia        | Muslim |        100
 Western Sahara | Muslim |        100
 Turkey         | Muslim |       99.8
 Afghanistan    | Muslim |         99
 Algeria        | Muslim |         99
 Iran           | Muslim |         99
(10 rows)
</pre>
<p>
Same as above, except we see the 6th-15th row using<span class="hlite"> OFFSET </span>
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country.name, religion.name, religion.percentage
FROM religion JOIN country ON country.code = religion.country
WHERE religion.name = 'Muslim' AND religion.percentage > 50
ORDER BY religion.percentage DESC, country.name
LIMIT 10 OFFSET 5;
      name      |  name  | percentage 
----------------+--------+------------
 Western Sahara | Muslim |        100
 Turkey         | Muslim |       99.8
 Afghanistan    | Muslim |         99
 Algeria        | Muslim |         99
 Iran           | Muslim |         99
 Gaza Strip     | Muslim |       98.7
 Morocco        | Muslim |       98.7
 Tunisia        | Muslim |         98
 Yemen          | Muslim |         98
 Iraq           | Muslim |         97
(10 rows)

</pre>
<p>
The only new thing here is the<span class="hlite"> IN() </span>condition that you can use in the WHERE command--to search for a series of specific numbers or strings [Yes, we could have looked for Muslim and Jewish religions by writing <span class="hlite">IN('Muslim','Jewish')</span>.]
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country.name, religion.name, religion.percentage
FROM religion JOIN country ON country.code = religion.country
WHERE religion.name = 'Muslim' AND religion.percentage IN (90,100);
      name      |  name  | percentage 
----------------+--------+------------
 Kosovo         | Muslim |         90
 Tajikistan     | Muslim |         90
 Bahrain        | Muslim |        100
 Saudi Arabia   | Muslim |        100
 Syria          | Muslim |         90
 Maldives       | Muslim |        100
 Mali           | Muslim |         90
 Mauritania     | Muslim |        100
 Western Sahara | Muslim |        100
 Somalia        | Muslim |        100
 Gambia         | Muslim |         90
 Mayotte        | Muslim |         90
(12 rows)

</pre>
<p>
Here we used the<span class="hlite"> LIKE() </span>conditional to search for religions that begin with the letter M.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country.name, religion.name, religion.percentage
FROM religion JOIN country ON country.code = religion.country
WHERE religion.name LIKE ('M%');
           name           |   name    | percentage 
--------------------------+-----------+------------
 Albania                  | Muslim    |         70
 Greece                   | Muslim    |        1.3
 Macedonia                | Muslim    |       33.3
 Serbia                   | Muslim    |        3.2
 Montenegro               | Muslim    |       17.7
 Kosovo                   | Muslim    |         90
 France                   | Muslim    |          8
 Germany                  | Muslim    |        3.7
 Italy                    | Muslim    |        2.1
 Slovenia                 | Muslim    |          1
 Switzerland              | Muslim    |        4.3
 Russia                   | Muslim    |         15
 Luxembourg               | Muslim    |          2
 Netherlands              | Muslim    |        5.8
 Bosnia and Herzegovina   | Muslim    |         40
 Croatia                  | Muslim    |        1.3
 Bulgaria                 | Muslim    |        7.8
 Turkey                   | Muslim    |       99.8
 Denmark                  | Muslim    |          2
 Norway                   | Muslim    |        1.8
 Gibraltar                | Muslim    |          8
 United Kingdom           | Muslim    |        2.7
 Afghanistan              | Muslim    |         99
 China                    | Muslim    |          2
 Iran                     | Muslim    |         99
 Pakistan                 | Muslim    |         97
 Tajikistan               | Muslim    |         90
 Turkmenistan             | Muslim    |         89
 Uzbekistan               | Muslim    |         88
 Georgia                  | Muslim    |        9.9
 Azerbaijan               | Muslim    |       93.4
 Bahrain                  | Muslim    |        100
 Bangladesh               | Muslim    |         83
 Myanmar                  | Muslim    |          4
 India                    | Muslim    |         14
 Brunei                   | Muslim    |         63
 Malaysia                 | Muslim    |       60.4
 Thailand                 | Muslim    |        3.8
 Vietnam                  | Muslim    |        0.1
 Kazakhstan               | Muslim    |         47
 Kyrgyzstan               | Muslim    |         75
 Mongolia                 | Muslim    |          4
 Nepal                    | Muslim    |          3
 Christmas Island         | Muslim    |         25
 Cocos Islands            | Muslim    |         80
 Cyprus                   | Muslim    |         18
 Gaza Strip               | Muslim    |       98.7
 Israel                   | Muslim    |       16.9
 Egypt                    | Muslim    |         94
 Indonesia                | Muslim    |         87
 Timor-Leste              | Muslim    |          1
 Iraq                     | Muslim    |         97
 Jordan                   | Muslim    |         92
 Kuwait                   | Muslim    |         85
 Saudi Arabia             | Muslim    |        100
 Syria                    | Muslim    |         90
 Lebanon                  | Muslim    |         70
 West Bank                | Muslim    |         75
 Maldives                 | Muslim    |        100
 Oman                     | Muslim    |         75
 United Arab Emirates     | Muslim    |         96
 Yemen                    | Muslim    |         98
 Philippines              | Muslim    |          5
 Qatar                    | Muslim    |         95
 Sri Lanka                | Muslim    |          8
 Anguilla                 | Methodist |       23.9
 Bahamas                  | Methodist |          6
 Guatemala                | Mayan     |          1
 Canada                   | Muslim    |        1.9
 United States            | Mormon    |        1.7
 United States            | Muslim    |        0.6
 El Salvador              | Mormon    |        0.7
 Trinidad and Tobago      | Muslim    |          6
 Turks and Caicos Islands | Methodist |         16
 Australia                | Muslim    |        1.7
 Fiji                     | Muslim    |          8

</pre>
<p>

<b>THEN WE MOVED TO ARREGRATE QUERIES:</b><br /><br />
First, we looked at some of the rows in the 'city' table.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT * from city;
                name                 | country |                 province                 | population | latitude | longitude | elevation 
-------------------------------------+---------+------------------------------------------+------------+----------+-----------+-----------
 Tirana                              | AL      | Albania                                  |     418495 |    41.33 |     19.82 |       110
 Shkodër                             | AL      | Albania                                  |      77075 |    42.07 |      19.5 |        13
 Durrës                              | AL      | Albania                                  |     113249 |    41.32 |     19.45 |         0
 Vlorë                               | AL      | Albania                                  |      79513 |    40.47 |     19.49 |        25
 Elbasan                             | AL      | Albania                                  |      78703 |     41.1 |     20.07 |       150
 Korçë                               | AL      | Albania                                  |      51152 |    40.62 |     20.77 |       850
 Komotini                            | GR      | Anatolikis Makedonias kai Thrakis        |            |     41.1 |     25.42 |        45
 Kavala                              | GR      | Anatolikis Makedonias kai Thrakis        |      58790 |    40.93 |      24.4 |         0
 Athina                              | GR      | Attikis                                  |     664046 |    37.97 |     23.72 |        70
 Peiraias                            | GR      | Attikis                       
 
</pre>
<p>
We decided to add up the populations of cities that share the same country, using the <span class="hlite">sum() </span>function. Note that we have to use the<span class="hlite"> GROUP BY </span>command to tell the computer what to add up. So for every row that shares the same 'country' it will add up the numbers in the 'population' column.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country, sum(population)
mondial2-# FROM city
mondial2-# GROUP BY country;

 country |    sum    
---------+-----------
 NEP     |   1699953
 RA      |  15351698
 CH      |   1381946
 L       |     99852
 AMSA    |          
 WD      |     14725
 LB      |   1010970
 BF      |   1965190
 EW      |    502624
 MV      |    133019
 BEN     |   1378292
 CAYM    |          
 SY      |     24970
 IRQ     |  12950153
 GROX    |          
 NOK     |   9087275
 MNG     |    760077
 MW      |   1335704
 AFG     |   3371100
 NZ      |   1222122
 BI      |    497166
</pre>
<p>

Here we added an<span class="hlite"> ORDER BY </span>command and got our resulting rows in ascending order.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country, sum(population)                                       
FROM city
GROUP BY country
ORDER BY sum(population);
 country |    sum    
---------+-----------
 MNTS    |         0
 PITC    |        56
 TOK     |       490
 V       |       842
 MC      |       975
 NLSM    |      1338
 SBAR    |      2299
 WL      |      3661
 RSM     |      4227
 TUV     |      4492
 FL      |      5241
 SPMI    |      5618
 SMAR    |      5700
 VIRG    |     10354
 M       |     12000
 PAL     |     12056
 FSM     |     12125
 FARX    |     12245
 WV      |     12909
 WD      |     14725
 KN      |     15500
 
</pre>
<p>
We tried switching to descending order using <span class="hlite">DESC </span>but all of the NULL VALUE sums showed up first. <span class="hlite">NULLS </span>are empty cells (entries) that don't have a number or anything entered into the column. NULLS are a challenge when working with data... [note: we could have written <span class="hlite">ORDER BY sum(population) DESC NULLS LAST</span>; to solve that problem.]
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country, sum(population)
FROM city
GROUP BY country
ORDER BY sum(population) DESC;
 country |    sum    
---------+-----------
 TUCA    |          
 GUAD    |          
 NORF    |          
 SVAX    |          
 AMSA    |          
 HELX    |          
 BERM    |          
 GBG     |          
 WAFU    |          
 ARU     |          
 BVIR    |          
 SP      |          
 NMIS    |          
 NIUE    |          
 FPOL    |          
 NCA     |          
 FALK    |          
 COCO    |          
 COOK    |          
 GUAM    |          
 GBJ     |          
 NAU     |   
</pre>
<p>
To get rid of the null values I added a<span class="hlite"> HAVING </span>command -- this works identically to WHERE but is used for testing aggregate values (sum(), max(), avg(), etc).
   </P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country, sum(population)
FROM city
GROUP BY country
HAVING sum(population) > 5000000
ORDER BY sum(population) DESC;
 country |    sum    
---------+-----------
 CN      | 326778593
 IND     | 129752758
 BR      |  93687185
 USA     |  81816121
 R       |  72000673
 J       |  48415803
 MEX     |  47137170
 RI      |  46627466
 TR      |  46045206
 IR      |  32393196
 ROK     |  32332901
 PK      |  29838311
 CO      |  26579496
 D       |  25333235
 GB      |  25252422
 RSA     |  23470701
 WAN     |  22757771
 ET      |  22364857
 RP      |  19594294
 E       |  18553641
 UA      |  17198533

  </pre>
<p>                           
Finally I introduced the concept of aliases using the<span class="hlite"> AS </span>command. Notice that this sum() is now referenced as total_pop, but I still had to explicitly write sum(population) in HAVING.
</P>
 <pre class="PROGRAMLISTING">
mondial2=# SELECT country, sum(population) AS total_pop
FROM city
GROUP BY country
HAVING sum(population) > 500000
ORDER BY total_pop;

 country | total_pop 
---------+-----------
 EW      |    502624
 TT      |    548299
 RWA     |    603049
 Q       |    612707
 MK      |    622712
 KWT     |    637411
 JA      |    662426
 LV      |    696618
 LAO     |    698318
 K       |    703963
 PY      |    741066
 RCA     |    746947
 G       |    747747
 MNG     |    760077
 CL      |    763466
 IRL     |    776488
 AL      |    818187
 RT      |    839566
 PR      |    858261
 WAL     |    922830
 TCH     |    951418

</pre>
<p></p>
 
  
  </div>


</div>
</div>
</body>
</html>
